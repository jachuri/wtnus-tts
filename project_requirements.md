# TTS 오디오 생성기 프로젝트 문서 (수정됨)

## 1. 프로젝트 개요
**목표**: WTN:US 대본 파일(마크다운)을 업로드하고, 웹 상에서 캐릭터별 보이스를 매핑하여 오디오를 생성/관리하는 웹 애플리케이션입니다. 생성된 오디오는 비교 및 선별 과정을 거쳐 최종적으로 하나의 ZIP 파일로 다운로드됩니다.
**배포**: Vercel
**저장소**: Git (GitHub/GitLab)

## 2. 핵심 워크플로우
1.  **로그인**: 비밀번호 입력 (환경변수 `SITE_PASSWORD` 확인).
2.  **대본 업로드**: 마크다운 파일 업로드 또는 붙여넣기.
3.  **캐릭터 매핑 (설정 단계)**:
    -   대본 분석 후 등장 캐릭터 목록 표시.
    -   각 캐릭터 옆에 보이스 ID 입력 란(또는 보이스 이름 선택) 제공.
    -   사용자가 직접 매핑 후 "생성 시작" 클릭.
4.  **오디오 생성 및 리뷰**:
    -   개별 대사별로 오디오 생성.
    -   **재생 기능**: 전체 재생 및 개별 대사 재생 지원.
    -   **재생성 및 비교**:
        -   마음에 들지 않는 대사는 "재생성" 가능.
        -   기존 파일을 덮어쓰지 않고 버전(Version)으로 관리하여 비교 청취 가능.
        -   사용자는 여러 버전 중 하나를 최종 선택(Select).
5.  **다운로드**:
    -   최종 선택된 오디오 파일들만 모아서 ZIP 압축.
    -   파일 이름은 대사 순서가 섞이지 않도록 순차적 번호링 적용 (예: `001_굳건_인사.mp3`).

## 3. 기능 상세 요구사항

### 3.1 대본 파싱 & 매핑 UI
-   **파싱 로직 유지**: `**[이름]** ... "[감정] 대사"` 형식 인식.
-   **매핑 인터페이스**:
    -   추출된 캐릭터 리스트 (중복 제거) 표시.
    -   ElevenLabs 보이스 목록을 API로 불러와서 드롭다운으로 제공 (또는 직접 ID 입력).

### 3.2 오디오 관리 (State Management)
-   각 대사 블록(Scene/Line)은 여러 개의 오디오 버전을 가질 수 있음.
-   **UI 구성**:
    -   대사 텍스트 표시.
    -   오디오 플레이어 (재생/일시정지).
    -   버전 탭/리스트 (v1, v2, v3...).
    -   "이 버전 선택(Select)" 체크박스/버튼.

### 3.3 다운로드
-   사용자가 선택한 버전(Selected Version)만 수집.
-   파일 명명 규칙: `000_SequenceNumber_CharacterName.mp3` (정렬 보장).

## 4. 기술 스택
-   **프레임워크**: Next.js (App Router)
-   **스타일링**: Tailwind CSS (프리미엄 다크 모드, Glassmorphism).
-   **상태 관리**: React Context 또는 Zustand (복잡한 오디오 버전 관리 필요).
-   **아이콘**: Lucide React.
-   **백엔드**: Next.js API Routes (ElevenLabs Proxy).

## 5. 환경 변수 (.env)
```bash
# 보안
SITE_PASSWORD=...

# ElevenLabs
ELEVENLABS_API_KEY=...
```
*(캐릭터별 보이스 ID 환경변수는 제거됨 - UI에서 동적 할당)*

## 6. 구현 단계 수정

### 1단계: 프로젝트 설정 및 공통 UI
-   Next.js, Tailwind 설정.
-   Login 페이지.

### 2단계: 대본 파싱 및 매핑 페이지
-   업로드 컴포넌트.
-   파싱 로직 구현.
-   보이스 ID 매핑 UI 구현 (ElevenLabs `/v1/voices` API 연동하여 목록 가져오기 추천).

### 3단계: 생성 페이지 및 오디오 플레이어
-   오디오 생성 API 연동.
-   **핵심**: 다중 버전 관리 UI 및 플레이어 구현.
-   개별 재생, 전체 재생(순차 재생) 로직 구현.

### 4단계: 다운로드 기능
-   선택된 오디오 필터링.
-   JSZip 패키징 및 다운로드.
